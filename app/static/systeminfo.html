<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Info - RSPI LocalServer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            background: white;
            border-radius: 15px;
            padding: 20px 30px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        h1 {
            font-size: 28px;
            color: #333;
        }

        .back-btn {
            padding: 10px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            text-decoration: none;
        }

        .back-btn:hover {
            opacity: 0.9;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }

        .stat-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .stat-icon {
            font-size: 32px;
            margin-right: 12px;
        }

        .stat-title {
            font-size: 16px;
            color: #666;
            font-weight: 600;
        }

        .stat-value {
            font-size: 36px;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }

        .stat-subtitle {
            font-size: 14px;
            color: #999;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: #f0f0f0;
            border-radius: 6px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: width 0.5s ease;
        }

        .progress-fill.warning {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
        }

        .progress-fill.danger {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .info-label {
            color: #666;
            font-size: 14px;
        }

        .info-value {
            color: #333;
            font-weight: 600;
            font-size: 14px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: white;
            font-size: 18px;
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }

            .info-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üíª System Information</h1>
            <a href="/" class="back-btn">üè† Dashboard</a>
        </header>

        <div id="content" class="loading">Loading system information...</div>
    </div>

    <script>
        let refreshInterval = null;

        async function fetchSystemInfo() {
            try {
                const response = await fetch("/api/system/info");
                if (!response.ok) {
                    throw new Error("Failed to fetch system info");
                }
                const data = await response.json();
                renderSystemInfo(data);
            } catch (e) {
                console.error("Error fetching system info:", e);
                document.getElementById("content").innerHTML = `
                    <div class="loading">Error loading system information</div>
                `;
            }
        }

        function renderSystemInfo(data) {
            const cpuColor = data.cpu.percent > 80 ? 'danger' : data.cpu.percent > 60 ? 'warning' : '';
            const memColor = data.memory.percent > 80 ? 'danger' : data.memory.percent > 60 ? 'warning' : '';
            const diskColor = data.disk.percent > 80 ? 'danger' : data.disk.percent > 60 ? 'warning' : '';

            const uptimeDays = Math.floor(data.uptime_seconds / 86400);
            const uptimeHours = Math.floor((data.uptime_seconds % 86400) / 3600);
            const uptimeMinutes = Math.floor((data.uptime_seconds % 3600) / 60);
            const uptimeStr = `${uptimeDays}d ${uptimeHours}h ${uptimeMinutes}m`;

            document.getElementById("content").innerHTML = `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon">‚ö°</div>
                            <div class="stat-title">CPU Usage</div>
                        </div>
                        <div class="stat-value">${data.cpu.percent}%</div>
                        <div class="stat-subtitle">${data.cpu.count} cores ${data.cpu.freq ? '@ ' + data.cpu.freq + ' MHz' : ''}</div>
                        <div class="progress-bar">
                            <div class="progress-fill ${cpuColor}" style="width: ${data.cpu.percent}%"></div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon">üíæ</div>
                            <div class="stat-title">Memory</div>
                        </div>
                        <div class="stat-value">${data.memory.percent}%</div>
                        <div class="stat-subtitle">${formatBytes(data.memory.used)} / ${formatBytes(data.memory.total)}</div>
                        <div class="progress-bar">
                            <div class="progress-fill ${memColor}" style="width: ${data.memory.percent}%"></div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon">üíΩ</div>
                            <div class="stat-title">Disk Usage</div>
                        </div>
                        <div class="stat-value">${data.disk.percent}%</div>
                        <div class="stat-subtitle">${formatBytes(data.disk.used)} / ${formatBytes(data.disk.total)}</div>
                        <div class="progress-bar">
                            <div class="progress-fill ${diskColor}" style="width: ${data.disk.percent}%"></div>
                        </div>
                    </div>

                    ${data.temperature ? `
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon">üå°Ô∏è</div>
                            <div class="stat-title">Temperature</div>
                        </div>
                        <div class="stat-value">${data.temperature}¬∞C</div>
                        <div class="stat-subtitle">${getTempStatus(data.temperature)}</div>
                    </div>
                    ` : ''}

                    <div class="stat-card" style="grid-column: 1 / -1;">
                        <div class="stat-header">
                            <div class="stat-icon">üìä</div>
                            <div class="stat-title">System Details</div>
                        </div>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">Model</span>
                                <span class="info-value">${data.model}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Platform</span>
                                <span class="info-value">${data.platform}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Uptime</span>
                                <span class="info-value">${uptimeStr}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Last Updated</span>
                                <span class="info-value">${new Date().toLocaleTimeString()}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function formatBytes(bytes) {
            const units = ["B", "KB", "MB", "GB", "TB"];
            let size = bytes;
            let unitIdx = 0;
            while (size >= 1024 && unitIdx < units.length - 1) {
                size /= 1024;
                unitIdx++;
            }
            return size.toFixed(unitIdx > 0 ? 1 : 0) + " " + units[unitIdx];
        }

        function getTempStatus(temp) {
            if (temp > 80) return "‚ö†Ô∏è High";
            if (temp > 70) return "‚ö° Warm";
            if (temp > 50) return "‚úì Normal";
            return "‚ùÑÔ∏è Cool";
        }

        // Initialize and auto-refresh
        fetchSystemInfo();
        refreshInterval = setInterval(fetchSystemInfo, 2000);
    </script>
</body>
</html>
